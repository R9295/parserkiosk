from commons import (
    {% for func in compare_funcs -%}
    {{ func }},
    {% endfor -%}
)

# assign me
{{ test_func }} = None

{% for test_name, test_dict in tests.items() %}
def {{test_name}}():
    {%- if test_dict.input.type == "file" %}
    data = None
    with open('fixtures/{{test_dict.input.arg}}', 'r') as file:
        data = file.read()
    {%- elif test_dict.input.type == "raw" %}
    data = {{ test_dict.input.arg }}
    {%- endif %}
    {% if test_dict.assert.func != "fail" -%}
            serialized_data = {{test_func}}(data)
    assert {{ test_dict.assert.func }}(serialized_data, {{ test_dict.assert.arg }})
    {% else -%}
    try:
        serialized_data = {{ test_func }}(data)
        assert False
    except Exception as e:
       assert str(e) == '{{test_dict.assert.arg}}'
    {%  endif %}
{% endfor %}
